<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Jay Sikotar Enterprise</title>
  <meta name="color-scheme" content="light dark" />
  <style>
    /* ====== Colorful but professional theme ====== */
    :root{
      /* Base */
      --bg: #0b0f14;
      --panel: #11151c;
      --text: #e9eef5;
      --muted: #7b8aa3;
      --border: #202838;

      /* Brand spectrum (cool & professional) */
      --brand-1: #2c7dfa;  /* primary blue */
      --brand-2: #7b5cff;  /* violet accent */
      --brand-3: #0fa3b1;  /* teal accent */

      /* UI helpers */
      --ring: 0 0 0 3px color-mix(in srgb, var(--brand-1) 32%, transparent);
      --radius: 14px;
      --shadow: 0 12px 32px rgba(0,0,0,.35);
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg: #f6f8fc;
        --panel: #ffffff;
        --text: #121824;
        --muted: #5a667a;
        --border: #e7ebf2;
        --shadow: 0 10px 24px rgba(27,40,66,.08);
      }
    }

    /* ====== Base ====== */
    *, *::before, *::after { box-sizing: border-box; }
    html, body { height: 100%; }
    body{
      margin:0;
      font: 16px/1.55 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color: var(--text);
      /* Soft colorful background that still feels professional */
      background:
        radial-gradient(1200px 800px at -10% -20%, color-mix(in srgb, var(--brand-2) 12%, transparent), transparent),
        radial-gradient(1400px 900px at 110% -30%, color-mix(in srgb, var(--brand-3) 12%, transparent), transparent),
        var(--bg);
    }
    .container{ max-width: 1120px; margin: 34px auto; padding: 0 18px; }

    header{
      display:flex; align-items:center; justify-content:space-between; gap:14px; margin-bottom: 22px;
    }
    .title{
      display:flex; align-items:center; gap:14px; padding: 10px 12px;
      border-radius: 14px;
      background:
        linear-gradient(135deg, color-mix(in srgb, var(--brand-1) 12%, var(--panel)), var(--panel));
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
    }
    .title h1{ margin:0; font-size: clamp(22px, 2.6vw, 30px); letter-spacing:.2px; }
    .title svg{ flex: 0 0 auto; color: var(--brand-1); }

    .grid{ display:grid; grid-template-columns: 1fr; gap: 18px; }
    @media (min-width: 860px){ .grid{ grid-template-columns: 400px 1fr; } }

    .card{
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
    }
    .card h2{
      margin:0; padding: 14px 16px;
      font-size: 16px; letter-spacing:.2px;
      color: var(--muted);
      border-bottom: 1px solid var(--border);
      background: linear-gradient(180deg, color-mix(in srgb, var(--panel) 100%, #000 0%), color-mix(in srgb, var(--panel) 88%, #000 12%));
    }
    .card .body{ padding: 16px; }

    /* ====== Form ====== */
    .form-row{ display:grid; grid-template-columns: 1fr; gap:12px; margin-bottom: 12px; }
    @media (min-width: 540px){
      .form-row.two{ grid-template-columns: 1fr 1fr; gap: 22px; } /* extra space Salary vs Date */
    }
    label{ display:block; font-size: 13px; color: var(--muted); margin: 0 0 6px; }
    select, input[type="text"], input[type="number"], input[type="date"], textarea{
      width:100%; padding:12px 12px; border-radius: 12px;
      border: 1px solid var(--border);
      background: color-mix(in srgb, var(--panel) 96%, #000 0%);
      color: var(--text);
      outline: none; transition: box-shadow .12s ease, border-color .12s ease, transform .06s ease;
    }
    select:focus, input:focus, textarea:focus{ border-color: var(--brand-1); box-shadow: var(--ring); }
    textarea{ min-height: 92px; resize: vertical; max-width:100%; width:100%; overflow-wrap: break-word; }
    .actions{ display:flex; gap: 10px; flex-wrap: wrap; margin-top: 8px; }

    /* Buttons with subtle gradient for a professional pop */
    .btn{
      --bg1: color-mix(in srgb, var(--brand-1) 92%, #000);
      --bg2: var(--brand-2);
      --fg: #fff;
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 14px; border-radius: 12px; border: 1px solid transparent;
      background: linear-gradient(135deg, var(--bg1), var(--bg2));
      color: var(--fg); font-weight: 600; cursor: pointer;
      transition: transform .06s ease, filter .15s ease;
    }
    .btn:hover{ filter: brightness(1.06) saturate(1.02); }
    .btn:active{ transform: translateY(1px); }

    .btn.secondary{
      background: linear-gradient(180deg, color-mix(in srgb, var(--panel) 96%, #000 4%), color-mix(in srgb, var(--panel) 88%, #000 12%));
      border-color: var(--border);
      color: var(--text);
    }
    .btn.ghost{
      background: transparent; border: 1px solid transparent; color: var(--muted);
    }
    .btn.danger{
      background: linear-gradient(135deg, #e34c4c, #ff6b6b);
      border-color: transparent;
    }

    /* ====== Toolbar ====== */
    .toolbar{
      display:flex; align-items:center; justify-content: space-between; gap: 12px;
      padding: 12px 16px; border-bottom: 1px solid var(--border);
      background: linear-gradient(180deg, color-mix(in srgb, var(--panel) 98%, #000 2%), color-mix(in srgb, var(--panel) 92%, #000 8%));
    }
    .search{
      display:flex; align-items:center; gap:8px; border:1px solid var(--border); border-radius:999px; padding: 8px 12px; width: min(380px, 100%);
      background: color-mix(in srgb, var(--panel) 98%, #000 2%);
    }
    .search input{ flex:1; background: transparent; border:0; outline:none; color: var(--text); }

    /* ====== Table / Cards ====== */
    table{ width:100%; border-collapse: collapse; }
    th, td{ padding: 12px 14px; border-bottom: 1px solid var(--border); text-align:left; }
    th{
      font-size: 13px; color: var(--muted); font-weight: 600;
      position: sticky; top:0; background: var(--panel); z-index: 1;
    }
    tbody tr:hover{ background: color-mix(in srgb, var(--panel) 90%, #000 10%); }
    .cell-actions{ display:flex; gap:8px; flex-wrap:wrap; }

    /* Salary: plain text, green only (no pills/boxes) */
    .money{
      color: #10b981; /* same green across themes for clarity */
      font-variant-numeric: tabular-nums;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }

    /* ====== Mobile card layout ====== */
    @media (max-width: 720px){
      table, thead, tbody, th, td, tr{ display:block; }
      thead{ display:none; }
      tbody tr{
        border: 1px solid var(--border); border-radius: 12px;
        margin: 10px 10px 12px; overflow: hidden;
        background: color-mix(in srgb, var(--panel) 98%, #000 2%);
      }
      tbody td{
        display:grid; grid-template-columns: 120px 1fr; gap: 8px; align-items: center;
        border-bottom: 1px solid var(--border);
      }
      tbody td:last-child{ border-bottom:0; }
      tbody td::before{ content: attr(data-label); font-size: 12px; color: var(--muted); }
      .cell-actions{ padding: 8px 0; }
    }

    /* ====== Toast ====== */
    .toast{
      position: fixed; bottom: 16px; left: 50%;
      transform: translateX(-50%) translateY(20px);
      opacity: 0; background: var(--panel); border: 1px solid var(--border); color: var(--text);
      padding: 10px 14px; border-radius: 999px; box-shadow: var(--shadow); transition: opacity .2s ease, transform .2s ease;
      pointer-events:none; z-index: 1000;
    }
    .toast.show{ opacity: 1; transform: translateX(-50%) translateY(0); }

    .empty{ display:flex; align-items:center; justify-content:center; padding: 24px; color: var(--muted); }
    .note{ font-size: 13px; color: var(--muted); margin-top: 8px; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="title">
        <svg width="30" height="30" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <defs>
            <linearGradient id="grad" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="currentColor"/>
              <stop offset="100%" stop-color="#7b5cff"/>
            </linearGradient>
          </defs>
          <g stroke="url(#grad)" stroke-width="1.6">
            <path d="M4 7a2 2 0 0 1 2-2h3l1-2h4l1 2h3a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V7Z"/>
            <path d="M8 11h8M8 15h5" stroke-linecap="round"/>
          </g>
        </svg>
        <h1>Jay Sikotar Enterprise</h1>
      </div>
      <!-- Subtitle & Badge removed as requested -->
    </header>

    <div class="grid">
      <!-- ENTRY FORM -->
      <section class="card" aria-labelledby="formTitle">
        <h2 id="formTitle">Employee Salary Entry</h2>
        <div class="body">
          <form id="entryForm" novalidate>
            <input type="hidden" id="entryId" />
            <div class="form-row">
              <div>
                <label for="employee">Employee Name <span aria-hidden="true">*</span></label>
                <select id="employee" name="employee" required>
                  <option value="" disabled selected>Select Employee</option>
                  <option>Saunak</option>
                  <option>Riya</option>
                  <option>Purvy</option>
                </select>
              </div>
            </div>

            <div class="form-row two">
              <div>
                <label for="salary">Salary <span aria-hidden="true">*</span></label>
                <input id="salary" name="salary" type="number" inputmode="decimal" step="100" min="0" placeholder="0" required />
              </div>
              <div>
                <label for="date">Date <span aria-hidden="true">*</span></label>
                <input id="date" name="date" type="date" required />
              </div>
            </div>

            <div class="form-row">
              <div>
                <label for="note">Note</label>
                <textarea id="note" name="note" placeholder="Optional note…"></textarea>
              </div>
            </div>

            <div class="actions">
              <button type="submit" class="btn" id="submitBtn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                  <path d="M5 12l4 4L19 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span id="submitLabel">Save Entry</span>
              </button>
              <button type="button" class="btn secondary" id="resetBtn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                  <path d="M3 12a9 9 0 1 0 9-9v3M3 3v6h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Reset Form
              </button>
            </div>
          </form>
        </div>
      </section>
      <!-- TABLE -->
      <section class="card" aria-labelledby="tableTitle">
        <div class="toolbar">
<h2 id="tableTitle" style="margin:0; font-size:16px; color:var(--muted)">Entries<a href="https://docs.google.com/spreadsheets/d/1dg8AvquK5ip5fVnkYxiG-o0mg9neMmXLKlZWwG4MYuU/edit?gid=0#gid=0" style="margin-left:10px;" target="_blank"><img alt="Google Sheets" src="https://www.gstatic.com/images/branding/product/1x/sheets_48dp.png" style="width:24px;height:24px;vertical-align:middle;"/></a></h2>
          <div style="display:flex; gap:10px; align-items:center;">
            <div style="display:flex;align-items:center;gap:.5rem;margin:.5rem 0;">
  <span id="entryCount"
        style="display:inline-block;min-width:2ch;padding:.15rem .4rem;border-radius:999px;background:#eef2ff;color:#1f2937;font-weight:600;text-align:center;">
    0
  </span>
</div>
            <div class="search" role="search">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M21 21l-4.3-4.3M10 18a8 8 0 1 1 0-16 8 8 0 0 1 0 16Z" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
              </svg>
              <input id="q" type="search" placeholder="Search entries…" aria-label="Search entries" />
            </div>
            <button class="btn ghost" id="exportCsvBtn" title="Export visible entries to CSV">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M12 3v12m0 0l-4-4m4 4l4-4M4 17v3h16v-3" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              Export CSV
            </button>
          </div>
        </div>

        <div class="body" style="padding:0">
          <table aria-describedby="tableTitle" id="entriesTable">
            <thead>
              <tr>
                <th scope="col">Employee Name</th>
                <th scope="col">Salary</th>
                <th scope="col">Date</th>
                <th scope="col">Note</th>
                <th scope="col" style="width:160px">Actions</th>
              </tr>
            </thead>
            <tbody id="entriesBody">
              <tr class="empty"><td colspan="5">No entries yet. Add your first one!</td></tr>
            </tbody>
          </table>
        </div>
      </section>
    </div>
  </div>

  <div class="toast" role="status" aria-live="polite" id="toast"></div>

  <script>
    // ========= CONFIG =========
    // Paste your Apps Script Web App URL (must end with /exec)
    const GOOGLE_SHEETS_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbzDV1J1-LqQvoA1Q6QsJ2YTYRFX5kCqCbigeFMLwcQH87XWiXURdmlx9PDbEtr--uqN/exec'; // e.g., 'https://script.google.com/macros/s/AKfycb.../exec'

    // ========= UTILITIES =========
    const $ = (sel, root = document) => root.querySelector(sel);
    const $$ = (sel, root = document) => Array.from(root.querySelectorAll(sel));
    const toISODate = (d) => new Date(d).toISOString().slice(0,10);
    const formatMoney = (n) => new Intl.NumberFormat('en-IN', { style:'currency', currency:'INR', maximumFractionDigits:0 }).format(Number(n||0));
    function showToast(msg){ const t = $('#toast'); t.textContent = msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'), 1800); }

    // ========= STORAGE =========
    const LS_KEY = 'salaryEntries:v2';
    const loadEntries = () => { try { return JSON.parse(localStorage.getItem(LS_KEY)) || []; } catch { return []; } };
    const saveEntries = (entries) => localStorage.setItem(LS_KEY, JSON.stringify(entries));

    // ========= STATE =========
    let entries = loadEntries(), editingId = null, query = '';

    // ========= DOM =========
    const form = $('#entryForm'), employee = $('#employee'), salary = $('#salary'), dateInput = $('#date'), note = $('#note');
    const entryId = $('#entryId'), submitBtn = $('#submitBtn'), submitLabel = $('#submitLabel'), resetBtn = $('#resetBtn');
    const q = $('#q'), tbody = $('#entriesBody'), exportBtn = $('#exportCsvBtn');

    // Default date = today
    dateInput.value = toISODate(new Date());

    // ========= RENDER =========
    function render(){
      const filtered = entries
        .filter(e => !query || (e.employee + ' ' + e.salary + ' ' + e.date + ' ' + (e.note||'')).toLowerCase().includes(query.toLowerCase()))
        .sort((a,b) => b.date.localeCompare(a.date));

      tbody.innerHTML = '';
      if(filtered.length === 0){
        const tr = document.createElement('tr'); tr.className='empty';
        const td = document.createElement('td'); td.colSpan=5; td.textContent = query ? 'No entries match your search.' : 'No entries yet. Add your first one!';
        tr.appendChild(td); tbody.appendChild(tr); return;
      }

      for(const e of filtered){
        const tr = document.createElement('tr');
        const c1 = td('Employee Name', e.employee);
        const c2 = td('Salary', formatMoney(e.salary), 'money'); // simple green money text
        const c3 = td('Date', e.date);
        const c4 = td('Note', e.note || '—', e.note ? '' : 'muted');
        const c5 = document.createElement('td'); c5.className='cell-actions'; c5.setAttribute('data-label','Actions');
        const editBtn = actionBtn('Edit', editIcon(), () => startEdit(e.id));
        const delBtn = actionBtn('Delete', trashIcon(), () => deleteEntry(e.id)); delBtn.classList.add('danger');
        c5.append(editBtn, delBtn); tr.append(c1,c2,c3,c4,c5); tbody.appendChild(tr);
      }
    }
    function td(label, text, extraClass=''){ const td = document.createElement('td'); td.setAttribute('data-label', label); if(extraClass) td.className = extraClass; td.textContent = text; return td; }
    function actionBtn(label, icon, onClick){ const b = document.createElement('button'); b.type='button'; b.className='btn secondary'; b.style.padding='8px 10px'; b.innerHTML = icon + '<span>'+label+'</span>'; b.onclick = onClick; return b; }
    function editIcon(){ return `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/><path d="M14.06 4.94l3.75 3.75" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/></svg>`; }
    function trashIcon(){ return `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 7h16M6 7l1 12a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2l1-12M9 7V5a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>`; }

    // ========= CRUD =========
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      if(!employee.value || !salary.value || !dateInput.value){ showToast('Please fill all required fields.'); return; }

      const data = {
        id: editingId || (crypto.randomUUID ? crypto.randomUUID() : String(Date.now())),
        employee: employee.value.trim(),
        salary: Number(salary.value),
        date: toISODate(dateInput.value),
        note: note.value.trim()
      };

      if(editingId){
        const idx = entries.findIndex(x => x.id === editingId);
        if(idx > -1) entries[idx] = data;
        showToast('Entry updated');
      }else{
        entries.push(data);
        showToast('Entry added');
      }
      saveEntries(entries);
      render();
      await sendToGoogleSheetsIfConfigured(data);
      resetForm();
    });

    function startEdit(id){
      const e = entries.find(x => x.id === id); if(!e) return;
      editingId = id; entryId.value = id; employee.value = e.employee; salary.value = e.salary; dateInput.value = e.date; note.value = e.note || '';
      submitLabel.textContent = 'Update Entry'; window.scrollTo({ top:0, behavior:'smooth' });
    }

    function deleteEntry(id){
      const e = entries.find(x => x.id === id); if(!e) return;
      if(confirm(`Delete salary entry for "${e.employee}" on ${e.date}?`)){
        entries = entries.filter(x => x.id !== id); saveEntries(entries); render(); showToast('Entry deleted');
      }
    }

    function resetForm(){ editingId = null; entryId.value=''; form.reset(); dateInput.value = toISODate(new Date()); submitLabel.textContent='Save Entry'; }
    resetBtn.addEventListener('click', resetForm);

    // ========= SEARCH =========
    q.addEventListener('input', () => { query = q.value.trim(); render(); });

    // ========= EXPORT CSV =========
    exportBtn.addEventListener('click', () => {
      const filtered = entries.filter(e => !query || (e.employee + ' ' + e.salary + ' ' + e.date + ' ' + (e.note||'')).toLowerCase().includes(query.toLowerCase()));
      if(filtered.length === 0){ showToast('Nothing to export'); return; }
      const rows = [['Employee Name','Salary (INR)','Date','Note'], ...filtered.map(e => [e.employee, e.salary, e.date, e.note||''])];
      const csv = rows.map(r => r.map(s => csvEscape(String(s))).join(',')).join('\r\n');
      const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
      const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = `salary_entries_${Date.now()}.csv`; a.click(); URL.revokeObjectURL(a.href);
      showToast('CSV exported');
    });
    function csvEscape(s){ return (s.includes('"') || s.includes(',') || s.includes('\n')) ? '"' + s.replace(/"/g,'""') + '"' : s; }

    // ========= GOOGLE SHEETS =========
    async function sendToGoogleSheetsIfConfigured(entry){
      if(!GOOGLE_SHEETS_WEB_APP_URL) return;

      const payload = JSON.stringify(entry);

      // Prefer sendBeacon (simple text/plain POST; avoids CORS preflight)
      if (navigator.sendBeacon) {
        try {
          const ok = navigator.sendBeacon(GOOGLE_SHEETS_WEB_APP_URL, new Blob([payload], { type: 'text/plain' }));
          if (ok) { showToast('Sync queued'); return; }
        } catch (e) {
          console.warn('sendBeacon failed, falling back to fetch:', e);
        }
      }

      // Fallback to simple fetch (no headers; no-cors)
      try{
        await fetch(GOOGLE_SHEETS_WEB_APP_URL, { method:'POST', mode:'no-cors', body: payload });
        showToast('Sync queued');
      }catch(err){
        console.warn('Sheets sync failed:', err);
        showToast('Sync failed (check console)');
      }
    }

    // ========= INIT =========
    render();
    q.addEventListener('keydown', (e)=>{ if(e.key==='Enter') q.blur(); });
  </script>
 
  <script>
  // Counts only real data rows (ignores header row and any placeholder row with colspan).
  function updateEntryCount() {
    const table = document.querySelector('table');
    if (!table) return;

    const allRows = Array.from(table.querySelectorAll('tr'));
    // Skip the header (first row), then exclude rows that contain a single cell spanning all columns.
    const dataRows = allRows.slice(1).filter(tr => !tr.querySelector('td[colspan]'));

    const countEl = document.getElementById('entryCount');
    if (countEl) countEl.textContent = dataRows.length;
  }

  document.addEventListener('DOMContentLoaded', () => {
    updateEntryCount();

    // If rows get added/removed dynamically, keep the number in sync:
    const table = document.querySelector('table');
    if (table) {
      const observer = new MutationObserver(updateEntryCount);
      observer.observe(table, { childList: true, subtree: true });
    }
  });
</script>
</body>
</html>
